<article id="content" 
  xmlns="http://www.w3.org/1999/xhtml" 
  xml:lang="en"
  lang="en"
  tal:define="breachs view/integrityBreaches"
  tal:condition="python: len(breachs)>0"
  i18n:domain="plone">
    <h1 class="documentFirstHeading"
        i18n:translate="linkintegrity_breaches_title">Potential link breakage</h1>

    <div id="content-core">
        <p i18n:translate="linkintegrity_instructions">
            By deleting this item, you will break links that exist in the items listed
            below. If this is indeed what you want to do, we recommend that you remove
            these references first.
        </p>

        <div>
            <article tal:repeat="breach breachs">

              <header>
                <a tal:attributes="href breach/url"
                    tal:content="breach/title" />
              </header>
              <p>
                  <span i18n:translate="linkintegrity_is_referenced">
                      This <span i18n:name="portal_type" tal:content="breach/type_title" />
                      is referenced by the following items:
                  </span>
              </p>

                  <ul>
                    <li tal:repeat="src python:breach['sources']">
                      <tal:visible condition="python: view.isAccessible(src)">
                        <a tal:attributes="href src/absolute_url" tal:content="src/Title" />
                        [<a tal:attributes="href string:${src/absolute_url}/edit"
                          i18n:translate="linkintegrity_edit_in_new_window"
                          target="_blank">Edit in new window</a>]
                      </tal:visible>
                      <tal:private condition="python: not view.isAccessible(src)"
                                   i18n:translate="linkintegrity_item_not_accessible">
                        The item is not accessible.
                      </tal:private>
                    </li>
                  </ul>

            </article>

        <br />

        <p i18n:translate="linkintegrity_delete_anyway">
            Would you like to delete it anyway?
        </p>

        </div>
    </div>
</article>